# Лабораторная работа №6. Многопоточные Android приложения.

## Цели
Получить практические навыки разработки многопоточных приложений:
1. Организация обработки длительных операций в background (worker) thread:
    * Запуск фоновой операции (coroutine/asynctask/thread)
    * Остановка фоновой операции (coroutine/asynctask/thread)
1. Публикация данных из background (worker) thread в main (ui) thread.

Освоить 3 основные группы API для разработки многопоточных приложений:
1. Kotlin Coroutines
1. AsyncTask
1. Java Threads

## Задачи
### Задача 1. Альтернативные решения задачи "не секундомер" из Лаб. 2
Используйте приложение "не секундомер", получившееся в результате выполнениня [Лабораторной работы №2](../02/TASK.md). Разработайте несколько альтернативных приложений "не секундомер", отличающихся друг от друга организацией многопоточной работы. Опишите все известные Вам решения.

#### Указания
К моменту выполнения работы Вам должно быть известно, как минимум, 4 принципиально разных подхода к решению задачи. В отчете должны появиться, как минимум, 3 решения:
1. С помощью Java Threads (фактически, это оригинальный код, однако на этот раз необходимо убедиться, что потоки запускаются и останавливаются в определенные моменты времени. Опишите эти моменты времени в отчете. Обратите внимание, что потоки не должны существовать, когда приложение не отображается на экране).
1. С помощью [AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html). Используйте метод `publishProgress` (аналогичный пример можно найти по [ссылке](http://developer.alexanderklimov.ru/android/theory/asynctask.php))
1. С помощью [Kotlin Coroutines](https://developer.android.com/kotlin/coroutines). В качестве знакомства с корутинами рекомендуется выполнить шаги 1-6 (включительно) из codelab: https://codelabs.developers.google.com/codelabs/kotlin-coroutines

Во всех случаях необходимо обращать внимание на то, когда запускаются потоки/задачи и когда они останавливаются: приложение не должно тратить впустую ресурсы ОС, когда оно не отображается на экране.

Как и в любом другом приложении, необходимо уделить особое внимание поведению приложения в ситуации перезапуска Activity (например, в результате поворота экрана). Не должно появляться более одного активного потока/задачи для подсчета времени.

Также можно улучшить точность подсчета времени. `sleep(1000)` не гарантирует остановку потока *ровно* на 1000 мс. Подумайте, как избавиться от накапливающейся ошибки. Для улучшения мыслительного процесса поменяйте `sleep(1000)` на `sleep(367)`, или любое другое простое число.

### Задача 2. Загрузка картинки в фоновом потоке (AsyncTask) 
Создайте приложение, которое скачивает картинку из интернета и размещает ее в `ImaveView` в `Activity`. За основу возьмите [код со StackOverflow](https://stackoverflow.com/a/9288544).

### Задача 3. Загрузка картинки в фоновом потоке (Kotlin Coroutines) 
Перепишите предыдущее приложение с использованием Kotlin Coroutines.

### Задача 4. Использование сторонних библиотек 
Многие "стандартные" задачи имеют "стандартные" решения. Задача скачивания изображения в фоне возникает настолько часто, что уже сравнительно давно решение этой задачи занимает всего лишь несколько строчек. Убедитесь в этом на примере одной (любой) библиотеки [Glide](https://github.com/bumptech/glide#how-do-i-use-glide), [picasso](https://square.github.io/picasso/) или [fresco](https://frescolib.org/docs/index.html).

### Задача 5* (по желанию). Using Kotlin Coroutines Codelab 
Выполните все шаги codelab https://codelabs.developers.google.com/codelabs/kotlin-coroutines

Результаты выполнения этого задания не обязательно отображать в отчёте. Выполнение этого задания не влияет на аттестацию.

# Отчет
Отчет должен содержать формулировку целей, решения задач с ответами на дополнительные вопросы, выводы. Выводы должны содержать убедительное обоснование, почему автор отчета считает, что все цели были достигнуты. Например, обоснование может включать краткую информацию о том, как достигалась каждая из поставленных целей.

В отчете укажите примерное время решения каждой из предложенных задач, включая время ознакомления со справочными материалами (время решения не влияет на оценку: только на анонимный сбор статистики для корректировки сложности задач в будущем).

# Вспомогательные материалы
## Основные
1. https://developer.android.com/kotlin/coroutines
1. http://developer.android.com/reference/android/os/AsyncTask.html
1. https://developer.android.com/reference/java/lang/Thread

## Дополнительные
1. http://developer.alexanderklimov.ru/android/theory/asynctask.php
1. https://github.com/Kotlin/KEEP/blob/master/proposals/coroutines.md
